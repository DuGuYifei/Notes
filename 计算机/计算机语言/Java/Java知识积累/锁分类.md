# 锁分类

## 总览

[锁升级](锁升级.md)
1. 偏向锁：偏向锁是指一段同步代码一直被一个线程所访问，那么该线程会自动获取锁，降低获取锁的代价。
2. 轻量级锁：当锁是偏向锁的时候，被另一个线程所访问，偏向锁就会升级为轻量级锁，其他线程会通过自旋的形式尝试获取锁，不会阻塞，提高性能。
3. 重量级锁：当自旋超过一定的次数，或者一个线程被阻塞，轻量级锁升级为重量级锁。重量级锁会让其他申请的线程进入阻塞状态，性能降低。它才是真正调用操作系统的Mutex Lock。

------------------------------------------------

1. 悲观锁：总是假设最坏的情况，每次拿数据都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会阻塞直到它拿到锁（**独占锁**）
2. 乐观锁：总是假设最好的情况，每次拿数据都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号等机制。乐观锁适用于多读的应用类型，这样可以提高吞吐量，像数据库提供的类似于write_condition机制，其实都是提供的乐观锁。在Java中java.util.concurrent.atomic包下面的原子变量类就是使用了乐观锁的一种实现方式CAS（CAS: Compare and Swap，比较并交换）实现的。[无锁操作](无锁操作.md)

------------------------------------------------

案例：[ReentrantLock](ReentrantLock.md)
1. 公平锁：按照申请锁的顺序来一次获得锁，先来后到
2. 非公平锁：一种获取锁的抢占机制，是随机获得锁的，和公平锁不一样的就是先来后到，非公平锁不管队列顺序，直接抢占，如果抢占成功就成功获取锁。