# 锁升级

## 顺序
biased lock -> lightweight lock -> heavyweight lock

1. 偏向锁：偏向锁是指一段同步代码一直被一个线程所访问，那么该线程会自动获取锁，降低获取锁的代价。
2. 轻量级锁：当锁是偏向锁的时候，被另一个线程所访问，偏向锁就会升级为轻量级锁，其他线程会通过自旋的形式尝试获取锁，不会阻塞，提高性能。
3. 重量级锁：当自旋超过一定的次数，或者一个线程被阻塞，轻量级锁升级为重量级锁。重量级锁会让其他申请的线程进入阻塞状态，性能降低。它才是真正调用操作系统的Mutex Lock。

所谓自旋：就是让该线程等待一段时间，不会被立即挂起，看持有锁的线程是否会很快释放锁，然后循环几次后，如果还是不能获取到锁，就会挂起。