# 文件读写和编码问题
```python
f = open('CustomerName.csv', 'w', encoding='utf-8')

for i in range(number):
    temp_name = choice(FIRST_NAMES)
    temp_surname = choice(LAST_NAMES)
    temp_person = f"{temp_name} {temp_surname}\n"
    f.write(temp_person)
f.close()
```


## 读写
### 读写1 (快)
```python
import os
import pandas as pd

merge_file = "./文件/合并完成文件/请复制别剪切.xlsx"
if not os.path.exists(merge_file):
    pd.DataFrame(None).to_excel(merge_file)
merge_content = pd.read_excel(
    merge_file,
    header=None,
    sheet_name=0
)
row = len(merge_content.values)

if not row:
    row = 2


for root, dirs, files in os.walk('./文件'):
    for filename in files:
        if (filename.endswith(".xlsx") or filename.endswith(".xls")) and filename != "请复制别剪切.xlsx":
            filename = root + "\\" + filename
            print(filename)
            content = pd.read_excel(
                filename,
                header=1,
                sheet_name=0
            )
            length = len(content.values) - 1
            if pd.isnull(content.values[length])[0]:
                content.drop(content.index[length], inplace=True)
            content.insert(0, '文件名', filename)
            merge_content = pd.concat([merge_content, content])

merge_content.to_excel(merge_file, header=False, index=False, startrow=row)

```

### 读写2(慢)
```python
from openpyxl import load_workbook
import os

first_file = True
merge_file = "./文件/合并完成文件/请复制别剪切.xlsx"
wbw = load_workbook(merge_file)
wbwSheet = wbw.worksheets[0]
if wbwSheet.max_row:
    first_file = False

for root, dirs, files in os.walk('./文件'):
    for filename in files:
        if filename.endswith(".xlsx") or filename.endswith(".xls") and filename != "请复制别剪切.xlsx":
            filename = root + "\\" + filename
            print(filename)
            wbr = load_workbook(filename)
            wbrSheet = wbr.worksheets[0]
            rowNum = 0

            for count in range(wbrSheet.max_row):
                rowNum += 1
                print(rowNum)
                if rowNum <= 2:
                    cellI = 2
                    wbwSheet.cell(rowNum, 1).value = "文件名"
                    for cell in wbrSheet[rowNum]:
                        wbwSheet.cell(rowNum, cellI).value = cell.value
                        cellI += 1
                else:
                    # 如果第一个单元格为空则跳过，因为最后一行是汇总数
                    if wbrSheet.cell(rowNum, 1).value is None:
                        continue
                    maxRow = wbwSheet.max_row
                    cellI = 2
                    wbwSheet.cell(maxRow + 1, 1).value = filename
                    for cell in wbrSheet[rowNum]:
                        wbwSheet.cell(maxRow + 1, cellI).value = cell.value
                        cellI += 1

wbw.save(merge_file)

```